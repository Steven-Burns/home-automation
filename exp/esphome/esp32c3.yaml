esphome:
  name: esp32c3-test

esp32:
  board: seeed_xiao_esp32c3
  framework:
    type: arduino

# Enable logging
logger:

# Enable Home Assistant API
api:
  password: ""

ota:
  - platform: esphome
    password: ""

wifi:
  ssid: "Son-of-pescadonet"
  password: "Patter69Son"

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: "Esp32C3-test Fallback Hotspot"
    password: "PJnNb7VRCS3I"

captive_portal:

web_server:

# this component sync the local gadget to the time of the Home Asst server
time:
  - platform: homeassistant
    id: esptime

i2c:
  sda: GPIO6
  scl: GPIO7
  # goose up the frequency so that we don't get runtime warnings about the display component
  # taking too long to update.
  frequency: 300kHz

font:
  - file: "fonts/spleen-5x8.bdf"
    id: spleen_font

qr_code:
  - id: homepage_qr
    value: https://arkadiahouse.us
    ecc: MEDIUM

display:
  - platform: ssd1306_i2c
    model: "SH1106 128x64"
    update_interval: 1s
    offset_x: 0
    offset_y: 0
    lambda: |-
      auto width = it.get_width();
      auto height = it.get_height();
      auto font_id = id(spleen_font);
      int char_height = 9;
      it.print(0, 0, font_id, "Hello World!");
      for (int i = 1; i < 8; ++i) 
      {
        it.printf(0, i * char_height, font_id, "line %d", i);
      }

      it.qr_code(width - 35, 16, id(homepage_qr), Color(255,255,255), 1);

switch:
  - platform: gpio
    id: "laser_beam_01"
    name: "LaserBeam"
    pin: GPIO5
  # - platform: ld2410
  #   engineering_mode:
  #     name: "mmWave sensor engineering mode"

binary_sensor:
  - platform: gpio
    name: "photodiode"
    pin: GPIO3
    filters:
      - delayed_on_off: 1s    
      - settle: 1s
  - platform: gpio
    name: "PIR Motion"
    pin: GPIO21
    device_class: motion
  - platform: gpio
    name: "Button0"
    pin:
      number: 2
      mode:
        input: true
        pulldown: true
    # filters:
    #   - settle: 0.2s
    on_multi_click:
    - timing:
        - ON for at most 0.75s
        - OFF for at most 0.3s
        - ON for at most 0.75s
        - OFF for at least 0.1s
      then:
        - logger.log: "Double Clicked"
    - timing:
        - ON for 0.75s to 3s
        - OFF for at least 0.1s
      then:
        - logger.log: "Single Long Clicked"
    - timing:
        - ON for at most 1s
        - OFF for at least 0.2s
      then:
        - logger.log: "Single Short Clicked"
        - switch.turn_on: laser_beam_01
      invalid_cooldown: 0.5s
  - platform: gpio
    name: "Button1"
    pin:
      number: 10
      mode:
        input: true
        pulldown: true
    # filters:
    #   - settle: 0.2s
    on_multi_click:
    - timing:
        - ON for at most 0.75s
        - OFF for at most 0.3s
        - ON for at most 0.75s
        - OFF for at least 0.1s
      then:
        - logger.log: "Double Clicked"
    - timing:
        - ON for 0.75s to 3s
        - OFF for at least 0.1s
      then:
        - logger.log: "Single Long Clicked"
    - timing:
        - ON for at most 1s
        - OFF for at least 0.2s
      then:
        - logger.log: "Single Short Clicked"
        - switch.turn_off: laser_beam_01
      invalid_cooldown: 0.5s
  - platform: gpio
    name: "Button2"
    pin:
      number: 8
      mode:
        input: true
        pulldown: true
    # filters:
    #   - settle: 0.2s
    on_multi_click:
    - timing:
        - ON for at most 0.75s
        - OFF for at most 0.3s
        - ON for at most 0.75s
        - OFF for at least 0.1s
      then:
        - logger.log: "Double Clicked"
    - timing:
        - ON for 0.75s to 3s
        - OFF for at least 0.1s
      then:
        - logger.log: "Single Long Clicked"
    - timing:
        - ON for at most 1s
        - OFF for at least 0.2s
      then:
        - logger.log: "Single Short Clicked"
      invalid_cooldown: 0.5s

light:
  - platform: esp32_rmt_led_strip
    id: led_strip
    rgb_order: GRB
    pin: GPIO9
    num_leds: 10
    rmt_channel: 0
    chipset: ws2812
    name: "My Light"
    default_transition_length: 0.5s
    effects:
      # Use default parameters:
      - random:
      # Customize parameters
      - random:
          name: "My Slow Random Effect"
          transition_length: 30s
          update_interval: 30s
      - random:
          name: "My Fast Random Effect"
          transition_length: 4s
          update_interval: 5s
      - pulse:
      - pulse:
          name: "Fast Pulse"
          transition_length: 0.5s
          update_interval: 0.5s
          min_brightness: 0%
          max_brightness: 100%
      - pulse:
          name: "Slow Pulse"
          # transition_length: 1s      # defaults to 1s
          update_interval: 2s
      - pulse:
          name: "Asymmetrical Pulse"
          transition_length:
            on_length: 1s
            off_length: 500ms
          update_interval: 1.5s
      - strobe:
      - strobe:
          name: Strobe Effect With Custom Values
          colors:
            - state: true
              brightness: 100%
              red: 100%
              green: 90%
              blue: 0%
              duration: 500ms
            - state: false
              duration: 250ms
            - state: true
              brightness: 100%
              red: 0%
              green: 100%
              blue: 0%
              duration: 500ms
      - flicker:
      - flicker:
          name: Flicker Effect With Custom Values
          alpha: 95%
          intensity: 1.5%
      - lambda:
          name: My Custom Effect
          update_interval: 1s
          lambda: |-
            static int state = 0;
            auto call = id(led_strip).turn_on();
            // Transition of 1000ms = 1s
            call.set_transition_length(1000);
            if (state == 0) {
              call.set_rgb(1.0, 1.0, 1.0);
            } else if (state == 1) {
              call.set_rgb(1.0, 0.0, 1.0);
            } else if (state == 2) {
              call.set_rgb(0.0, 0.0, 1.0);
            } else {
              call.set_rgb(1.0, 0.0, 0.0);
            }
            call.perform();
            state += 1;
            if (state == 4)
              state = 0;
      - addressable_rainbow:
      - addressable_rainbow:
          name: Rainbow Effect With Custom Values
          speed: 10
          width: 5
      - addressable_color_wipe:
      - addressable_color_wipe:
          name: Color Wipe Effect With Custom Values
          colors:
            - red: 100%
              green: 100%
              blue: 100%
              num_leds: 5
              gradient: true
            - red: 0%
              green: 0%
              blue: 0%
              num_leds: 1
          add_led_interval: 100ms
          reverse: true
      - addressable_scan:
      - addressable_scan:
          name: Scan Effect With Custom Values
          move_interval: 100ms
          scan_width: 2
      - addressable_twinkle:
      - addressable_twinkle:
          name: Twinkle Effect With Custom Values
          twinkle_probability: 5%
          progress_interval: 4ms
      - addressable_random_twinkle:
      - addressable_random_twinkle:
          name: Random Twinkle Effect With Custom Values
          twinkle_probability: 5%
          progress_interval: 32ms
      - addressable_fireworks:
      - addressable_fireworks:
          name: Fireworks Effect With Custom Values
          update_interval: 32ms
          spark_probability: 10%
          use_random_color: false
          fade_out_rate: 120
      - addressable_flicker:
      - addressable_flicker:
          name: addressable Flicker Effect With Custom Values
          update_interval: 16ms
          intensity: 5%
      - addressable_lambda:
          name: "lambda"
          update_interval: 16ms
          lambda: |-
            // it.size() - Number of LEDs
            // it[num] - Access the LED at index num.
            // Set the LED at num to the given r, g, b values
            // it[num] = Color(r, g, b);
            // Get the color at index num (Color instance)
            // it[num].get();

            // Example: Simple color wipe
            for (int i = it.size() - 1; i > 0; i--) {
              it[i] = it[i - 1].get();
            }
            it[0] = Color::random_color();

            // Bonus: use .range() and .all() to set many LEDs without having to write a loop.
            // it.range(0, 50) = Color::BLACK;
            it.all().fade_to_black(10);          

# display:
#   - platform: addressable_light
#     id: led_matrix_display
#     addressable_light_id: led_strip
#     width: 10
#     height: 1


  # - platform: gpio
  #   pin: GPIO7
  #   name: "mmWave Presence"
  #   device_class: presence
  # - platform: ld2410
  #   has_target:
  #     name: Presence
  #   has_moving_target:
  #     name: Moving Target
  #   has_still_target:
  #     name: Still Target
  #   out_pin_presence_status:
  #     name: out pin presence status

# uart:
#   id: uart_01
#   tx_pin: GPIO21
#   rx_pin: GPIO20
#   baud_rate: 256000

# ld2410:
#   uart_id: uart_01

sensor:
  - platform: dht
    pin: GPIO4
    temperature:
      name: "Temperature"
      accuracy_decimals: 1
      device_class: temperature
      filters:
        - delta: 0.1
        - heartbeat: 30s
    humidity:
      name: "Humidity"
      accuracy_decimals: 1
      device_class: humidity
      filters:
        - delta: 0.1
        - heartbeat: 30s        
    update_interval: 31s
  
  # - platform: ld2410
  #   light:
  #     name: light
  #   moving_distance:
  #     name : Moving Distance
  #   still_distance:
  #     name: Still Distance
  #   moving_energy:
  #     name: Move Energy
  #   still_energy:
  #     name: Still Energy
  #   detection_distance:
  #     name: Detection Distance
  #   g0:
  #     move_energy:
  #       name: g0 move energy
  #     still_energy:
  #       name: g0 still energy
  #   g1:
  #     move_energy:
  #       name: g1 move energy
  #     still_energy:
  #       name: g1 still energy
  #   g2:
  #     move_energy:
  #       name: g2 move energy
  #     still_energy:
  #       name: g2 still energy
  #   g3:
  #     move_energy:
  #       name: g3 move energy
  #     still_energy:
  #       name: g3 still energy
  #   g4:
  #     move_energy:
  #       name: g4 move energy
  #     still_energy:
  #       name: g4 still energy
  #   g5:
  #     move_energy:
  #       name: g5 move energy
  #     still_energy:
  #       name: g5 still energy
  #   g6:
  #     move_energy:
  #       name: g6 move energy
  #     still_energy:
  #       name: g6 still energy
  #   g7:
  #     move_energy:
  #       name: g7 move energy
  #     still_energy:
  #       name: g7 still energy
  #   g8:
  #     move_energy:
  #       name: g8 move energy
  #     still_energy:
  #       name: g8 still energy

# number:
#   - platform: ld2410
#     timeout:
#       name: timeout
#     light_threshold:
#       name: light threshold
#     max_move_distance_gate:
#       name: max move distance gate
#     max_still_distance_gate:
#       name: max still distance gate
#     g0:
#       move_threshold:
#         name: g0 move threshold
#       still_threshold:
#         name: g0 still threshold
#     g1:
#       move_threshold:
#         name: g1 move threshold
#       still_threshold:
#         name: g1 still threshold
#     g2:
#       move_threshold:
#         name: g2 move threshold
#       still_threshold:
#         name: g2 still threshold
#     g3:
#       move_threshold:
#         name: g3 move threshold
#       still_threshold:
#         name: g3 still threshold
#     g4:
#       move_threshold:
#         name: g4 move threshold
#       still_threshold:
#         name: g4 still threshold
#     g5:
#       move_threshold:
#         name: g5 move threshold
#       still_threshold:
#         name: g5 still threshold
#     g6:
#       move_threshold:
#         name: g6 move threshold
#       still_threshold:
#         name: g6 still threshold
#     g7:
#       move_threshold:
#         name: g7 move threshold
#       still_threshold:
#         name: g7 still threshold
#     g8:
#       move_threshold:
#         name: g8 move threshold
#       still_threshold:
#         name: g8 still threshold



